{
  "permissions": {
    "allow": [
      "Bash(docker compose exec:*)",
      "Bash(docker logs:*)",
      "Bash(docker compose:*)",
      "Bash(timeout 30 bash:*)",
      "Bash(find:*)",
      "Bash(python -m alembic:*)",
      "Bash(python -m py_compile:*)",
      "Bash(npm test:*)",
      "Bash(npx react-scripts test -- --coverage --watchAll=false)",
      "Bash(node node_modules/.bin/react-scripts test:*)",
      "Bash(npm install:*)",
      "Bash(docker images:*)",
      "Bash(curl:*)",
      "Bash(python3:*)",
      "Bash(npx tsc:*)",
      "Bash(python -m pytest:*)",
      "Bash(.venvScriptspython.exe -m pytest --tb=short -v)",
      "Bash(npm run build:*)",
      "Bash(rm:*)",
      "Bash(ls:*)",
      "Bash(grep:*)",
      "Bash(cat:*)",
      "Bash(node -e:*)",
      "Bash(powershell -Command \"\\(Get-Content ''c:\\\\Users\\\\zmzer\\\\Documents\\\\freelancing\\\\engine\\\\investigation.md'' | Measure-Object -Line\\).Lines\")",
      "Bash(powershell -Command:*)",
      "Bash(python -m json.tool:*)",
      "Bash(timeout 15 docker compose logs:*)",
      "Bash(python:*)",
      "Bash(timeout 5 docker compose:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njc1MzQxNywiaWF0IjoxNzY2NzUxNjE3LCJqdGkiOiI1MWE4ZmY2NC04ZGRmLTRmY2YtOGZhMy0yMzYwYTE4ZTRkZWEifQ.yTbtoBM69ZmvhrGpsWvAQYrCt7Hwhk0Iz6PoGvu27J4\")",
      "Bash(timeout 15 curl -s -X POST \"http://localhost:9000/admin/webhook/send?target_url=http://app:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" )",
      "Bash(timeout 10 curl:*)",
      "Bash(timeout 30 docker compose:*)",
      "Bash(timeout 20 docker compose logs:*)",
      "Bash(timeout 10 docker compose:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njc3NTIxMCwiaWF0IjoxNzY2NzczNDEwLCJqdGkiOiIxNDY3NGYyYy1kMTFlLTQyOGYtOTdiMy0yNWVhZmMwZTEyNWIifQ.cWtK2yHOV11fGFvf4Pj_Ow0ZDw3xIgTOYYZL3JJNzcM\")",
      "Bash(timeout 15 docker compose:*)",
      "Bash(docker ps:*)",
      "Bash(docker stop:*)",
      "Bash(docker rm:*)",
      "Bash(docker restart:*)",
      "Bash(docker exec:*)",
      "Bash(timeout 10 bash -c 'sleep 5 && curl -s http://127.0.0.1:9000/health')",
      "Bash(findstr:*)",
      "Bash(timeout 15 bash:*)",
      "Bash(timeout 30 curl:*)",
      "Bash(timeout 5 curl:*)",
      "Bash(timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\"\"user_id\"\":\"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\"\"secret\"\":\"\"ecd78c38d5ec54b4cd892735d0423671\"\",\"\"source\"\":\"\"tradingview\"\",\"\"timestamp\"\":\"\"2025-12-27T12:00:00\"\",\"\"tv\"\":{\"\"exchange\"\":\"\"mock\"\",\"\"symbol\"\":\"\"BTC/USDT\"\",\"\"timeframe\"\":60,\"\"action\"\":\"\"buy\"\",\"\"market_position\"\":\"\"long\"\",\"\"market_position_size\"\":200,\"\"prev_market_position\"\":\"\"flat\"\",\"\"prev_market_position_size\"\":0,\"\"entry_price\"\":1,\"\"close_price\"\":1,\"\"order_size\"\":200},\"\"strategy_info\"\":{\"\"trade_id\"\":\"\"test001\"\",\"\"alert_name\"\":\"\"Test\"\",\"\"alert_message\"\":\"\"Test\"\"},\"\"execution_intent\"\":{\"\"type\"\":\"\"signal\"\",\"\"side\"\":\"\"buy\"\",\"\"position_size_type\"\":\"\"quote\"\",\"\"precision_mode\"\":\"\"auto\"\"},\"\"risk\"\":{\"\"max_slippage_percent\"\":1.0}}')",
      "Bash(timeout 60 curl:*)",
      "Bash(for PAIR in BTCUSDT ETHUSDT ADAUSDT XRPUSDT DOGEUSDT LINKUSDT TRXUSDT LTCUSDT AVAXUSDT)",
      "Bash(do)",
      "Bash(echo:*)",
      "Bash(done)",
      "Bash(for PAIR in BTCUSDT ETHUSDT SOLUSDT ADAUSDT XRPUSDT DOGEUSDT LINKUSDT TRXUSDT LTCUSDT AVAXUSDT)",
      "Bash(timeout 15 curl:*)",
      "Bash(for price in 0.99 0.97 0.94)",
      "Bash(__NEW_LINE__ curl -s -X PUT \"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\" -H \"Content-Type: application/json\" -d '{\"\"price\"\": 93000}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:01:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 200, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 200, \"\"entry_price\"\": 93000, \"\"close_price\"\": 93000, \"\"order_size\"\": 200},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_2\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 2\"\", \"\"alert_message\"\": \"\"Second pyramid\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ curl -s -X PUT \"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\" -H \"Content-Type: application/json\" -d '{\"\"price\"\": 91000}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:02:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 200, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 200, \"\"entry_price\"\": 91000, \"\"close_price\"\": 91000, \"\"order_size\"\": 200},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_3\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 3\"\", \"\"alert_message\"\": \"\"Third pyramid - should be rejected\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:01:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 93000, \"\"close_price\"\": 93000, \"\"order_size\"\": 500},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_2\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 2\"\", \"\"alert_message\"\": \"\"Second pyramid\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:02:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 91000, \"\"close_price\"\": 91000, \"\"order_size\"\": 500},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_3\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 3\"\", \"\"alert_message\"\": \"\"Third pyramid - SHOULD BE REJECTED\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:03:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 89000, \"\"close_price\"\": 89000, \"\"order_size\"\": 500},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_4\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 4\"\", \"\"alert_message\"\": \"\"Fourth pyramid - SHOULD BE REJECTED\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg3NzYzNCwiaWF0IjoxNzY2ODc1ODM0LCJqdGkiOiI1MjQyOTgzNy01MjlhLTRkYjYtODhjNC0zM2E3MjRiZWJjYTMifQ.FGx7vVL8jVCdVoCESZ35KubIWiU8Seaxr1icSq1GkEk\")",
      "Bash(time timeout 30 curl:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg3OTYwNywiaWF0IjoxNzY2ODc3ODA3LCJqdGkiOiI2NzA0MjhiYS00NzUwLTQxYWEtOGNmZi0zOWZkY2IzZjYyYzkifQ.HqF2PG5d-fp6aqn09RBaynF-udAptCFNfztx8M5hTi8\":*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg4MDMzNCwiaWF0IjoxNzY2ODc4NTM0LCJqdGkiOiJmMmFjYzA0Mi1iMDUxLTRhOTAtYjE2Ni0xM2Q0OTQ0MDEyYzMifQ.4yiAVC7gzRsHx9OKT7y_3J6rsRXMKfa9oCVE6p-i_-0\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg4MDcwMiwiaWF0IjoxNzY2ODc4OTAyLCJqdGkiOiIyM2YzMjI1MS1lZDQ3LTRiOGQtYWQzOC0yMmViNGQxNDU3NWQifQ.S1yevdAUtrhPvunxD-yjzQwzNzvvFB1PVxDg15j7vPI\")",
      "Bash(# Re-login and try again timeout 10 curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" timeout 10 curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\")",
      "Bash(# Refresh cookie curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" # Check BTC position echo \"\"Current positions:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# All-in-one refresh and check curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" && curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Set up prices curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 200}'' curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 95000}'' echo \"\"Prices set: SOL=200, BTC=95000\"\" # Create new cookie curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" echo \"\"Logged in\"\" # Check current positions echo \"\"Current active positions:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Create SOL position \\(will be winner\\) timeout 60 curl -s -X POST \"\"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\"\" -H \"\"Content-Type: application/json\"\" -d ''{ \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\", \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\", \"\"source\"\": \"\"tradingview\"\", \"\"timestamp\"\": \"\"2025-12-28T01:05:00\"\", \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"SOL/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"flat\"\", \"\"prev_market_position_size\"\": 0, \"\"entry_price\"\": 200, \"\"close_price\"\": 200, \"\"order_size\"\": 500}, \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"sol_hedge_test\"\", \"\"alert_name\"\": \"\"SOL Hedge Test\"\", \"\"alert_message\"\": \"\"Entry for hedge test\"\"}, \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"}, \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0} }'' | python -m json.tool)",
      "Bash(# Raise SOL to make it profitable curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 250}'' echo \"\"SOL raised to 250\"\" sleep 3 # Check positions echo \"\"\"\" echo \"\"Positions:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Reset prices curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 200}'' curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 90000}'' # Create new SOL position timeout 60 curl -s -X POST \"\"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\"\" -H \"\"Content-Type: application/json\"\" -d ''{ \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\", \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\", \"\"source\"\": \"\"tradingview\"\", \"\"timestamp\"\": \"\"2025-12-28T01:15:00\"\", \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"SOL/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"flat\"\", \"\"prev_market_position_size\"\": 0, \"\"entry_price\"\": 200, \"\"close_price\"\": 200, \"\"order_size\"\": 500}, \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"sol_winner_v3\"\", \"\"alert_name\"\": \"\"SOL Winner V3\"\", \"\"alert_message\"\": \"\"Careful winner\"\"}, \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"}, \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0} }'' sleep 3 # Check positions echo \"\"\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Wait a bit for orders to be submitted then check positions sleep 3 curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Drop SOL to fill orders curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 190}'' echo \"\"SOL dropped to 190\"\" sleep 4 # Raise SOL to just below TP threshold \\(2% from avg entry ~196 = ~200\\) curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 203}'' echo \"\"SOL raised to 203 \\(just below TP\\)\"\" sleep 2 # Check positions echo \"\"\"\" echo \"\"Position states:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Add another pyramid to BTC timeout 60 curl -s -X POST \"\"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\"\" -H \"\"Content-Type: application/json\"\" -d ''{ \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\", \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\", \"\"source\"\": \"\"tradingview\"\", \"\"timestamp\"\": \"\"2025-12-28T01:16:00\"\", \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 90000, \"\"close_price\"\": 90000, \"\"order_size\"\": 500}, \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr3\"\", \"\"alert_name\"\": \"\"BTC Pyramid 3\"\", \"\"alert_message\"\": \"\"Max pyramids\"\"}, \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"}, \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0} }'' sleep 2 # Check BTC position curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(sleep 3 curl -s -b cookies.txt \"http://127.0.0.1:8000/api/v1/positions/active\")",
      "Bash(timeout 5 bash -c 'sleep 3 && curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\"')",
      "Bash(# Drop BTC to fill remaining orders curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 85000}'' echo \"\"BTC dropped to 85000 to fill remaining orders\"\" timeout 5 bash -c ''sleep 3'' # Check BTC position curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Check remaining BTC orders and current price curl -s \"\"http://127.0.0.1:9000/admin/symbols\"\" | python -m json.tool)",
      "Bash(timeout 10 bash:*)",
      "Bash(timeout 20 bash -c 'for i in {1..20}; do curl -s http://127.0.0.1:8000/health > /dev/null && echo \"\"App ready\"\" && exit 0; sleep 1; done; echo \"\"Timeout\"\"')",
      "Bash(# Now check risk status again curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/risk/status\"\")",
      "Bash(# Set all timers as expired for all positions docker compose exec db psql -U tv_user -d tv_engine_db -c \"\"UPDATE position_groups SET risk_timer_start = NOW\\(\\) - INTERVAL ''10 minutes'', risk_timer_expires = NOW\\(\\) - INTERVAL ''5 minutes'', risk_eligible = true WHERE exchange = ''mock'';\"\" # Check risk status curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/risk/status\"\")",
      "Bash(# Get raw response curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/risk/status\"\")",
      "Bash(1 echo \"\" echo \"Exit code: $?\")",
      "Bash(Select-String -Pattern \"risk|offset\" -CaseSensitive:$false)",
      "Bash(.venv/Scripts/python.exe -m pytest tests/test_mock_connector.py -v)",
      "Bash(.venv/bin/python -m pytest tests/test_mock_connector.py -v)",
      "Bash(.venv/Scripts/python.exe -m pytest tests/test_signal_router_coverage.py -v --tb=short)",
      "Bash(timeout 120 docker compose exec app python -m pytest:*)",
      "Bash(timeout 180 docker compose exec app python -m pytest:*)",
      "Bash(timeout 60 docker compose exec app python -m pytest:*)",
      "Bash(timeout 700 docker compose exec app python -m pytest:*)",
      "Bash(timeout 300 docker compose exec app python -m pytest:*)",
      "Bash(timeout 120 docker compose exec app python:*)",
      "Bash(timeout 180 docker compose exec app python:*)",
      "Bash(FILTER_BRANCH_SQUELCH_WARNING=1 git filter-branch:*)",
      "Bash(git stash:*)",
      "Bash(timeout 25 bash -c 'for i in {1..25}; do curl -s http://127.0.0.1:8000/health > /dev/null && echo \"\"App ready\"\" && exit 0; sleep 1; done; echo \"\"Timeout\"\"')",
      "Bash(timeout 60 docker exec:*)",
      "Bash(timeout 90 docker exec:*)",
      "Bash(timeout 700 docker exec:*)",
      "Bash(timeout 20 bash -c 'for i in {1..20}; do curl -s http://127.0.0.1:9000/health > /dev/null && echo \"\"Mock exchange ready\"\" && exit 0; sleep 1; done; echo \"\"Timeout\"\"')",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(wc:*)",
      "Bash(timeout 180 python:*)",
      "Bash(timeout 60 python:*)",
      "Bash(timeout 120 python:*)",
      "Bash(timeout 60 docker compose:*)",
      "Bash(CI=true npm test -- --testPathPattern=\"QueuePage.test.tsx\" --no-coverage)",
      "Bash(timeout 600 python:*)",
      "Bash(timeout 300 python:*)",
      "Bash(timeout 150 python:*)",
      "Bash(timeout 450 python:*)",
      "Bash(timeout:*)",
      "Bash(git checkout:*)",
      "Bash(xargs -I {} bash -c 'echo \"\"=== {} ===\"\" && grep \"\"def test_\"\" {} | wc -l')",
      "Bash(xargs -I {} bash -c 'echo \"\"=== {} ===\"\" && grep \"\"async def\\\\|^def \"\" {} | head -15')",
      "Bash(CI=true npm test -- --testPathPattern=\"SettingsPage.test.tsx\" --no-coverage)",
      "Bash(docker info:*)",
      "Bash(CI=true npm test -- --testPathPattern=\"dcaConfig.test.ts\" --no-coverage)",
      "Bash(CI=true npm test -- --testPathPattern=\"DCAConfigForm.test.tsx\" --no-coverage)",
      "Bash(CI=true npm test -- --coverage)",
      "Bash(CI=true npm test -- --coverage --watchAll=false)",
      "Bash(CI=true npm run build:*)",
      "Bash(__NEW_LINE__ echo \"Binance configs created\")",
      "Bash(__NEW_LINE__ echo \"Mock tests sent\")",
      "Bash(__NEW_LINE__ echo \"Binance tests sent\")",
      "Bash(__NEW_LINE__ echo \"Bybit tests sent\")",
      "Bash(__NEW_LINE__ echo \"Bybit webhooks sent\")",
      "Bash(# Check user settings and DCA configs for Bybit docker compose exec db psql -U tv_user -d tv_engine_db -c \"\"SELECT * FROM users WHERE username = ''zmomz'';\"\")",
      "Bash(__NEW_LINE__ echo \"\")",
      "Bash(# Re-login and check positions cd c:/Users/zmzer/Documents/freelancing/engine curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" # Check risk status echo \"\"Risk status:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/risk/status\"\")",
      "Bash(# Test basic connectivity cd c:/Users/zmzer/Documents/freelancing/engine # Check if app is responding on health timeout 5 curl -s http://127.0.0.1:8000/api/v1/users/login -X POST -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" 2>&1 cat login_response.txt)",
      "Bash(powershell -ExecutionPolicy Bypass -File \"c:\\\\Users\\\\zmzer\\\\Documents\\\\freelancing\\\\engine\\\\setup_risk_test.ps1\")",
      "Bash(powershell -ExecutionPolicy Bypass -File \"c:\\\\Users\\\\zmzer\\\\Documents\\\\freelancing\\\\engine\\\\send_test_signals.ps1\")",
      "Bash(powershell:*)",
      "Bash(# Get SOL step size curl -s \"\"http://127.0.0.1:9000/admin/symbols\"\")",
      "Bash(# Check SOL symbol details docker compose exec mock-exchange curl -s localhost:9000/admin/symbols)",
      "Bash(# Check current state echo \"\"=== Current Positions ===\"\" docker compose exec db psql -U tv_user -d tv_engine_db -c \"\"SELECT COUNT\\(*\\) as count FROM position_groups WHERE status = ''active'';\"\" echo \"\"\"\" echo \"\"=== Mock Exchange Symbols ===\"\" curl -s \"\"http://127.0.0.1:9000/admin/symbols\"\" | python -m json.tool)",
      "Bash(# Login first curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" # Check existing DCA configs for mock exchange echo \"\"Checking DCA configs for mock...\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/dca-configs?exchange=mock\"\")",
      "Bash(# Fresh login and try curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" # Now create config with verbose output curl -v -b cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/dca-configs\"\" \\\\ -H \"\"Content-Type: application/json\"\" \\\\ -d ''{\"\"exchange\"\":\"\"mock\"\",\"\"symbol\"\":\"\"BTC/USDT\"\",\"\"timeframe\"\":60,\"\"is_active\"\":true,\"\"max_pyramids\"\":2,\"\"order_type\"\":\"\"market\"\",\"\"position_size_type\"\":\"\"quote\"\",\"\"position_size\"\":100,\"\"tp_percent\"\":5.0,\"\"tp_mode\"\":\"\"aggregate\"\",\"\"dca_levels\"\":[{\"\"level\"\":0,\"\"drop_percent\"\":0,\"\"size_multiplier\"\":1.0}]}'' 2>&1)",
      "Bash(# Refresh login curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" # Check active positions echo \"\"=== ACTIVE POSITIONS ===\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\")",
      "Bash(python -c:*)"
    ]
  }
}
