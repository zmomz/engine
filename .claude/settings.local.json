{
  "permissions": {
    "allow": [
      "Bash(docker compose exec:*)",
      "Bash(docker logs:*)",
      "Bash(docker compose:*)",
      "Bash(timeout 30 bash:*)",
      "Bash(find:*)",
      "Bash(python -m alembic:*)",
      "Bash(python -m py_compile:*)",
      "Bash(npm test:*)",
      "Bash(npx react-scripts test -- --coverage --watchAll=false)",
      "Bash(node node_modules/.bin/react-scripts test:*)",
      "Bash(npm install:*)",
      "Bash(docker images:*)",
      "Bash(curl:*)",
      "Bash(python3:*)",
      "Bash(npx tsc:*)",
      "Bash(python -m pytest:*)",
      "Bash(.venvScriptspython.exe -m pytest --tb=short -v)",
      "Bash(npm run build:*)",
      "Bash(rm:*)",
      "Bash(ls:*)",
      "Bash(grep:*)",
      "Bash(cat:*)",
      "Bash(node -e:*)",
      "Bash(powershell -Command \"\\(Get-Content ''c:\\\\Users\\\\zmzer\\\\Documents\\\\freelancing\\\\engine\\\\investigation.md'' | Measure-Object -Line\\).Lines\")",
      "Bash(powershell -Command:*)",
      "Bash(python -m json.tool:*)",
      "Bash(timeout 15 docker compose logs:*)",
      "Bash(python:*)",
      "Bash(timeout 5 docker compose:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njc1MzQxNywiaWF0IjoxNzY2NzUxNjE3LCJqdGkiOiI1MWE4ZmY2NC04ZGRmLTRmY2YtOGZhMy0yMzYwYTE4ZTRkZWEifQ.yTbtoBM69ZmvhrGpsWvAQYrCt7Hwhk0Iz6PoGvu27J4\")",
      "Bash(timeout 15 curl -s -X POST \"http://localhost:9000/admin/webhook/send?target_url=http://app:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" )",
      "Bash(timeout 10 curl:*)",
      "Bash(timeout 30 docker compose:*)",
      "Bash(timeout 20 docker compose logs:*)",
      "Bash(timeout 10 docker compose:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njc3NTIxMCwiaWF0IjoxNzY2NzczNDEwLCJqdGkiOiIxNDY3NGYyYy1kMTFlLTQyOGYtOTdiMy0yNWVhZmMwZTEyNWIifQ.cWtK2yHOV11fGFvf4Pj_Ow0ZDw3xIgTOYYZL3JJNzcM\")",
      "Bash(timeout 15 docker compose:*)",
      "Bash(docker ps:*)",
      "Bash(docker stop:*)",
      "Bash(docker rm:*)",
      "Bash(docker restart:*)",
      "Bash(docker exec:*)",
      "Bash(timeout 10 bash -c 'sleep 5 && curl -s http://127.0.0.1:9000/health')",
      "Bash(findstr:*)",
      "Bash(timeout 15 bash:*)",
      "Bash(timeout 30 curl:*)",
      "Bash(timeout 5 curl:*)",
      "Bash(timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\"\"user_id\"\":\"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\"\"secret\"\":\"\"ecd78c38d5ec54b4cd892735d0423671\"\",\"\"source\"\":\"\"tradingview\"\",\"\"timestamp\"\":\"\"2025-12-27T12:00:00\"\",\"\"tv\"\":{\"\"exchange\"\":\"\"mock\"\",\"\"symbol\"\":\"\"BTC/USDT\"\",\"\"timeframe\"\":60,\"\"action\"\":\"\"buy\"\",\"\"market_position\"\":\"\"long\"\",\"\"market_position_size\"\":200,\"\"prev_market_position\"\":\"\"flat\"\",\"\"prev_market_position_size\"\":0,\"\"entry_price\"\":1,\"\"close_price\"\":1,\"\"order_size\"\":200},\"\"strategy_info\"\":{\"\"trade_id\"\":\"\"test001\"\",\"\"alert_name\"\":\"\"Test\"\",\"\"alert_message\"\":\"\"Test\"\"},\"\"execution_intent\"\":{\"\"type\"\":\"\"signal\"\",\"\"side\"\":\"\"buy\"\",\"\"position_size_type\"\":\"\"quote\"\",\"\"precision_mode\"\":\"\"auto\"\"},\"\"risk\"\":{\"\"max_slippage_percent\"\":1.0}}')",
      "Bash(timeout 60 curl:*)",
      "Bash(for PAIR in BTCUSDT ETHUSDT ADAUSDT XRPUSDT DOGEUSDT LINKUSDT TRXUSDT LTCUSDT AVAXUSDT)",
      "Bash(do)",
      "Bash(echo:*)",
      "Bash(done)",
      "Bash(for PAIR in BTCUSDT ETHUSDT SOLUSDT ADAUSDT XRPUSDT DOGEUSDT LINKUSDT TRXUSDT LTCUSDT AVAXUSDT)",
      "Bash(timeout 15 curl:*)",
      "Bash(for price in 0.99 0.97 0.94)",
      "Bash(__NEW_LINE__ curl -s -X PUT \"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\" -H \"Content-Type: application/json\" -d '{\"\"price\"\": 93000}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:01:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 200, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 200, \"\"entry_price\"\": 93000, \"\"close_price\"\": 93000, \"\"order_size\"\": 200},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_2\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 2\"\", \"\"alert_message\"\": \"\"Second pyramid\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ curl -s -X PUT \"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\" -H \"Content-Type: application/json\" -d '{\"\"price\"\": 91000}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:02:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 200, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 200, \"\"entry_price\"\": 91000, \"\"close_price\"\": 91000, \"\"order_size\"\": 200},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_3\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 3\"\", \"\"alert_message\"\": \"\"Third pyramid - should be rejected\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:01:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 93000, \"\"close_price\"\": 93000, \"\"order_size\"\": 500},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_2\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 2\"\", \"\"alert_message\"\": \"\"Second pyramid\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:02:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 91000, \"\"close_price\"\": 91000, \"\"order_size\"\": 500},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_3\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 3\"\", \"\"alert_message\"\": \"\"Third pyramid - SHOULD BE REJECTED\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(__NEW_LINE__ timeout 60 curl -s -X POST \"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\" -H \"Content-Type: application/json\" -d '{\n  \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\",\n  \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\",\n  \"\"source\"\": \"\"tradingview\"\",\n  \"\"timestamp\"\": \"\"2025-12-27T12:03:00\"\",\n  \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 89000, \"\"close_price\"\": 89000, \"\"order_size\"\": 500},\n  \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr_4\"\", \"\"alert_name\"\": \"\"BTC Pyramid Test 4\"\", \"\"alert_message\"\": \"\"Fourth pyramid - SHOULD BE REJECTED\"\"},\n  \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"},\n  \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0}\n}')",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg3NzYzNCwiaWF0IjoxNzY2ODc1ODM0LCJqdGkiOiI1MjQyOTgzNy01MjlhLTRkYjYtODhjNC0zM2E3MjRiZWJjYTMifQ.FGx7vVL8jVCdVoCESZ35KubIWiU8Seaxr1icSq1GkEk\")",
      "Bash(time timeout 30 curl:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg3OTYwNywiaWF0IjoxNzY2ODc3ODA3LCJqdGkiOiI2NzA0MjhiYS00NzUwLTQxYWEtOGNmZi0zOWZkY2IzZjYyYzkifQ.HqF2PG5d-fp6aqn09RBaynF-udAptCFNfztx8M5hTi8\":*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg4MDMzNCwiaWF0IjoxNzY2ODc4NTM0LCJqdGkiOiJmMmFjYzA0Mi1iMDUxLTRhOTAtYjE2Ni0xM2Q0OTQ0MDEyYzMifQ.4yiAVC7gzRsHx9OKT7y_3J6rsRXMKfa9oCVE6p-i_-0\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ6bW9teiIsImV4cCI6MTc2Njg4MDcwMiwiaWF0IjoxNzY2ODc4OTAyLCJqdGkiOiIyM2YzMjI1MS1lZDQ3LTRiOGQtYWQzOC0yMmViNGQxNDU3NWQifQ.S1yevdAUtrhPvunxD-yjzQwzNzvvFB1PVxDg15j7vPI\")",
      "Bash(# Re-login and try again timeout 10 curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" timeout 10 curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\")",
      "Bash(# Refresh cookie curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" # Check BTC position echo \"\"Current positions:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# All-in-one refresh and check curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" && curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Set up prices curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 200}'' curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 95000}'' echo \"\"Prices set: SOL=200, BTC=95000\"\" # Create new cookie curl -s -c cookies.txt -X POST \"\"http://127.0.0.1:8000/api/v1/users/login\"\" -H \"\"Content-Type: application/x-www-form-urlencoded\"\" -d \"\"username=zmomz&password=zm0mzzm0mz\"\" echo \"\"Logged in\"\" # Check current positions echo \"\"Current active positions:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Create SOL position \\(will be winner\\) timeout 60 curl -s -X POST \"\"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\"\" -H \"\"Content-Type: application/json\"\" -d ''{ \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\", \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\", \"\"source\"\": \"\"tradingview\"\", \"\"timestamp\"\": \"\"2025-12-28T01:05:00\"\", \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"SOL/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"flat\"\", \"\"prev_market_position_size\"\": 0, \"\"entry_price\"\": 200, \"\"close_price\"\": 200, \"\"order_size\"\": 500}, \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"sol_hedge_test\"\", \"\"alert_name\"\": \"\"SOL Hedge Test\"\", \"\"alert_message\"\": \"\"Entry for hedge test\"\"}, \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"}, \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0} }'' | python -m json.tool)",
      "Bash(# Raise SOL to make it profitable curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 250}'' echo \"\"SOL raised to 250\"\" sleep 3 # Check positions echo \"\"\"\" echo \"\"Positions:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Reset prices curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 200}'' curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 90000}'' # Create new SOL position timeout 60 curl -s -X POST \"\"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\"\" -H \"\"Content-Type: application/json\"\" -d ''{ \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\", \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\", \"\"source\"\": \"\"tradingview\"\", \"\"timestamp\"\": \"\"2025-12-28T01:15:00\"\", \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"SOL/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"flat\"\", \"\"prev_market_position_size\"\": 0, \"\"entry_price\"\": 200, \"\"close_price\"\": 200, \"\"order_size\"\": 500}, \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"sol_winner_v3\"\", \"\"alert_name\"\": \"\"SOL Winner V3\"\", \"\"alert_message\"\": \"\"Careful winner\"\"}, \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"}, \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0} }'' sleep 3 # Check positions echo \"\"\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Wait a bit for orders to be submitted then check positions sleep 3 curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Drop SOL to fill orders curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 190}'' echo \"\"SOL dropped to 190\"\" sleep 4 # Raise SOL to just below TP threshold \\(2% from avg entry ~196 = ~200\\) curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/SOLUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 203}'' echo \"\"SOL raised to 203 \\(just below TP\\)\"\" sleep 2 # Check positions echo \"\"\"\" echo \"\"Position states:\"\" curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Add another pyramid to BTC timeout 60 curl -s -X POST \"\"http://127.0.0.1:8000/api/v1/webhooks/f937c6cb-f9f9-4d25-be19-db9bf596d7e1/tradingview\"\" -H \"\"Content-Type: application/json\"\" -d ''{ \"\"user_id\"\": \"\"f937c6cb-f9f9-4d25-be19-db9bf596d7e1\"\", \"\"secret\"\": \"\"ecd78c38d5ec54b4cd892735d0423671\"\", \"\"source\"\": \"\"tradingview\"\", \"\"timestamp\"\": \"\"2025-12-28T01:16:00\"\", \"\"tv\"\": {\"\"exchange\"\": \"\"mock\"\", \"\"symbol\"\": \"\"BTC/USDT\"\", \"\"timeframe\"\": 60, \"\"action\"\": \"\"buy\"\", \"\"market_position\"\": \"\"long\"\", \"\"market_position_size\"\": 500, \"\"prev_market_position\"\": \"\"long\"\", \"\"prev_market_position_size\"\": 500, \"\"entry_price\"\": 90000, \"\"close_price\"\": 90000, \"\"order_size\"\": 500}, \"\"strategy_info\"\": {\"\"trade_id\"\": \"\"btc_pyr3\"\", \"\"alert_name\"\": \"\"BTC Pyramid 3\"\", \"\"alert_message\"\": \"\"Max pyramids\"\"}, \"\"execution_intent\"\": {\"\"type\"\": \"\"signal\"\", \"\"side\"\": \"\"buy\"\", \"\"position_size_type\"\": \"\"quote\"\", \"\"precision_mode\"\": \"\"auto\"\"}, \"\"risk\"\": {\"\"max_slippage_percent\"\": 1.0} }'' sleep 2 # Check BTC position curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(sleep 3 curl -s -b cookies.txt \"http://127.0.0.1:8000/api/v1/positions/active\")",
      "Bash(timeout 5 bash -c 'sleep 3 && curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\"')",
      "Bash(# Drop BTC to fill remaining orders curl -s -X PUT \"\"http://127.0.0.1:9000/admin/symbols/BTCUSDT/price\"\" -H \"\"Content-Type: application/json\"\" -d ''{\"\"price\"\": 85000}'' echo \"\"BTC dropped to 85000 to fill remaining orders\"\" timeout 5 bash -c ''sleep 3'' # Check BTC position curl -s -b cookies.txt \"\"http://127.0.0.1:8000/api/v1/positions/active\"\" | python -m json.tool)",
      "Bash(# Check remaining BTC orders and current price curl -s \"\"http://127.0.0.1:9000/admin/symbols\"\" | python -m json.tool)",
      "Bash(timeout 10 bash:*)",
      "Bash(timeout 20 bash -c 'for i in {1..20}; do curl -s http://127.0.0.1:8000/health > /dev/null && echo \"\"App ready\"\" && exit 0; sleep 1; done; echo \"\"Timeout\"\"')"
    ]
  }
}
